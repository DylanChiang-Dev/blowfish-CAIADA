{{ if .Get "src" }}
  {{ $image := .Page.Resources.GetMatch (printf "*%s*" (.Get "src")) }}
  {{ if $image }}
    <figure{{ with .Get "class" }} class="{{ . }}"{{ end }}>
      {{- if .Get "href" -}}
        <a href="{{ .Get "href" }}">
      {{- end -}}
      <img src="{{ $image.RelPermalink }}"
        {{- if or (.Get "alt") (.Get "caption") }}
          alt="{{ with .Get "alt" }}{{ . }}{{ else }}{{ .Get "caption" | markdownify | plainify }}{{ end }}"
        {{- end -}}
        width="100%"
        height="auto"
        style="max-width:{{ div $image.Width 2 }}px; max-height:{{ div $image.Height 2 }}px;"
      />
      {{- if .Get "href" }}</a>{{ end -}}
      {{- if .Get "caption" -}}
        <figcaption>
          {{- .Get "caption" | markdownify -}}
        </figcaption>
      {{- end }}
    </figure>
  {{ else }}
    <!-- 圖片資源未找到：{{ .Get "src" }} -->
    <div class="bg-gray-100 p-4 rounded border">
      <p class="text-gray-600">圖片載入失敗：{{ .Get "src" }}</p>
      {{ if .Get "alt" }}<p class="text-sm text-gray-500">{{ .Get "alt" }}</p>{{ end }}
    </div>
  {{ end }}
{{ end }}
